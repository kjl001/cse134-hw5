<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="description" content="HW5 Part 1">
	<meta name="keywords" content="HTML">
	<meta name="author" content="Kevin Lee">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HW5 Part 1</title>
	<link href="images/favicon.ico" rel="icon">
</head>

<body>
	<form>
		<p id="record_id" name="record_id"></p>
		<input type="text" id="article_name" name="article_name">
		<textarea id="article_body" name="article_body" rows="4" cols="50"></textarea>
		<input type="hidden" id="date" name="date">
	</form>

	<button type="button" id="postBtn"></button>
	<button type="button" id="getBtn"></button>
	<button type="button" id="putBtn"></button>
	<button type="button" id="deleteBtn"></button>

	<output id="response"></output>

	<script type="module">
		window.addEventListener('DOMContentLoaded', init);

		function init() {
			document.getElementById('postBtn').addEventListener('click', handlePost);
			document.getElementById('getBtn').addEventListener('click', handleGet);
			document.getElementById('putBtn').addEventListener('click', handlePut);
		}

		async function handlePost() {
			const response = await fetch(`https://httpbin.org/post`, {
				method: 'POST',
				mode: 'cors',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
					'X-Sent-By': 'javascript'
				},
				body: encodeURIComponent(`message=${new Date()}`)
			});

			if (response.ok) {
				let responseText = await response.text();
				document.getElementById("date").innerHTML = responseText;
			}
			else {
				console.log("Post Function Error");
			}
		}

		async function handleGet() {
			const response = await fetch('https://httpbin.org/get', {
				method: 'GET'
			});

			if (response.ok) {
				const data = await response.json();
				document.getElementById('response').innerText = data.stringify();
			}
			else {
				console.log('Get Function Error')
			}
		}

		async function handlePut() {
			const data = {
				record_id: '5',
				article_name: 'Man Yells at Cloud',
				article_body: 'Old man decides to be angry at everything, including clouds.',
				date: `${new Date()}`
			};
			const response = await fetch('https://httpbin.org/put', {
				method: 'PUT',
				headers: {

				},
				body: JSON.stringify(data)
			});

			if (response.ok) {
				const data = await response.json();
				console.log(data.stringify());
			} else {
				console.log("Put Function Error");
			}
		}
	</script>
</body>
</html>